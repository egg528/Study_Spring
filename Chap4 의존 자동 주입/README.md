# 3. 의존 자동 주입

## 의존 자동 주입이란?
- 의존 대상을 설정 코드에서 직접 주입하지 않고 스프링이 자동으로 의존하는 빈 객체를 주입해주는 기능.  
- 스프링에서는 의존 자동 주입을 위해 @Autowired 애노테이션을 활용한다.


### `2개 이상의 공통 타입 빈 중 의존 객체 선택하기`
- @Qulifier 애노테이션을 통한 특정 빈을 지정하여 의존 객체를 선택하게 된다.
  

### `상위/하위 타입 관계와 자동 주입`
- A 클래스와 A클래스를 상속한 AA 클래스가 빈으로 등록되어 있다고 가정하자.
- A 타입의 의존을 주입해야할 때 Spring은 오류를 발생시킨다.
- A 클래스도 A 타입의 객체가 될 수 있고, AA 클래스도 될 수 있기 때문이다.
- 해결 방안은 크게 2가지이다.
- @Qulifier로 특정 빈을 특정하거나 객체 타입을 하위 클래스로 변환하는 방법이 있다.  

### `@Autowired(required = false)`
- @Autowired를 붙인 필드 혹은 메서드의 매개변수에 할당할 빈이 없으면 Spring은 Exception을 발생시킨다.
- 하지만 꼭 객체가 할당되어야 하는 게 아니라면?
- required = false를 통해 이러한 경우 예외가 발생하지 않도록 설정할 수 있다.
- 추가적으로 required = false 대신 Optional을 사용해도 같은 결과를 볼 수 있다.
- 또한 @Nullable 애노테이션도 같은 효과를 볼 수 있다.
- 단, 차이점이 있다면 required = false의 경우 주입할 빈이 없을 때 주입 자체를 하지 않지만
- Nullable은 null을 주입하고, Optional 또한 값이 null인 Optional을 주입한다.

### `만약 설정 정보에서도 의존을 주입하고, 해당 클래스에서도 @Autowired 애노테이션이 붙어있다면?`
- 설정 정보에서 빈 객체를 생성하기 위해 Setter 메서드로 의존을 주입하고, 해당 클래스에서도 @Autowired를 통해 의존이 주입된다면?
- 해당 클래스의 @Autowired가 기준점이 된다.
- 하지만, 이러한 혼란을 줄이기 위해 설정 클래스에서 의존을 수동 주입하기 보다는
- 스프링의 의존 자동 주입을 일관되게 사용하는 편이 좋다.


### `필드 주입 / 생성자 주입 / Setter 주입`
- @Autowired를 활용해 의존성을 주입하는 방법은 위와 같이 3가지가 있다.
- 필드 주입
  - 코드가 정말 간결하다...
  - 하지만 외부에서 변경이 불가능하다는 단점이 있다.
  - 테스트 코드 작성 시 객체를 수정할 수 없다는 단점 때문에 권장되지 않는다.
- 생성자 주입
  - 주입 받은 객체가 변하지 않는데.
  - 반드시 객체 주입이 필요한 경우에 적합하다.
  - 생성자가 1개일 경우 @Autowired 생략 가능
  - final 키워드를 사용할 수 있다.
  - 순환 참조 에러 문제 해결할 수 있다.
- Setter 주입
  - 주입 받는 객체를 변경하기 용이하다.
